"use strict";exports.id=8979,exports.ids=[8979],exports.modules={18979:(a,b,c)=>{c.d(b,{appConfigService:()=>e});class d{constructor(){this.configuration=null,this.loading=!1,this.error=null,this.lastFetch=0,this.cacheTimeout=1e4}async fetchConfiguration(){if(this.configuration&&!this.shouldRefetch())return this.configuration;if(this.loading){for(;this.loading;)await new Promise(a=>setTimeout(a,100));return this.configuration}try{let a;this.loading=!0,this.error=null;let b=await fetch("/api/configuration",{method:"GET",headers:{"Content-Type":"application/json"}});if(!b.ok)throw Error(`Failed to fetch configuration: ${b.status}`);let c=await b.json();return a=0===c.length?this.getFallbackConfiguration():this.transformFlatArrayToStructured(c),this.configuration=a,this.lastFetch=Date.now(),a}catch(a){return this.error=a instanceof Error?a.message:"Unknown error",console.error("Failed to fetch app configuration:",a),this.getFallbackConfiguration()}finally{this.loading=!1}}shouldRefetch(){return Date.now()-this.lastFetch>this.cacheTimeout}getFallbackConfiguration(){return{internal:[{app_name:"tiered_pricing",is_active:!1}],external:[{app_name:"dealer_locator",configurations:{token:""},is_active:!1},{app_name:"google_recaptcha",configurations:{site_key:"",locations:{login:!1,signup:!1,checkout:!1}},is_active:!1},{app_name:"google_tag_manager",configurations:{container_id:""},is_active:!1},{app_name:"google_maps",configurations:{api_key:""},is_active:!1},{app_name:"google_analytics",configurations:{measurement_id:""},is_active:!1},{app_name:"google_adsense",configurations:{publisher_id:""},is_active:!1},{app_name:"google_search_console",configurations:{verification_meta_tag:""},is_active:!1}]}}transformFlatArrayToStructured(a){let b=[],c=[];return a.forEach(a=>{a.configurations||"tiered_pricing"!==a.app_name?["dealer_locator","google_recaptcha","google_tag_manager","google_maps","google_analytics","google_adsense","google_search_console","will-call"].includes(a.app_name)&&c.push({app_name:a.app_name,configurations:a.configurations||{},is_active:a.is_active}):b.push({app_name:a.app_name,is_active:a.is_active})}),{internal:b,external:c}}getExternalConfig(a){if(!this.configuration)return null;let b=this.configuration.external?.find(b=>b.app_name===a);return b?.is_active?b.configurations:null}getInternalConfig(a){if(!this.configuration)return!1;let b=this.configuration.internal?.find(b=>b.app_name===a);return b?.is_active??!1}isAppActive(a){if(!this.configuration)return!1;let b=this.configuration.external?.find(b=>b.app_name===a);if(b)return b.is_active;let c=this.configuration.internal?.find(b=>b.app_name===a);return c?.is_active??!1}getGoogleRecaptchaConfig(){return this.getExternalConfig("google_recaptcha")}isRecaptchaEnabledFor(a){if(!this.isAppActive("google_recaptcha"))return!1;let b=this.getGoogleRecaptchaConfig();return b?.locations?.[a]??!1}getGoogleTagManagerConfig(){return this.getExternalConfig("google_tag_manager")}getGoogleMapsConfig(){return this.getExternalConfig("google_maps")}getGoogleAnalyticsConfig(){return this.getExternalConfig("google_analytics")}getGoogleAdSenseConfig(){return this.getExternalConfig("google_adsense")}getGoogleSearchConsoleConfig(){return this.getExternalConfig("google_search_console")}isDealerLocatorEnabled(){return this.getInternalConfig("dealer_locator")}isWillCallEnabled(){return this.isAppActive("will-call")}getLastError(){return this.error}clearCache(){this.configuration=null,this.lastFetch=0,this.error=null}setCacheTimeout(a){this.cacheTimeout=a}}let e=new d}};