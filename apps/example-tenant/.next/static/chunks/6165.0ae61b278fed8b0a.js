"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[6165],{66165:(e,t,i)=>{i.d(t,{appConfigService:()=>a});class n{async fetchConfiguration(){if(this.configuration&&!this.shouldRefetch())return this.configuration;if(this.loading){for(;this.loading;)await new Promise(e=>setTimeout(e,100));return this.configuration}try{let e;this.loading=!0,this.error=null;let t=await fetch("/api/configuration",{method:"GET",headers:{"Content-Type":"application/json"}});if(!t.ok)throw Error("Failed to fetch configuration: ".concat(t.status));let i=await t.json();return e=0===i.length?this.getFallbackConfiguration():this.transformFlatArrayToStructured(i),this.configuration=e,this.lastFetch=Date.now(),e}catch(e){return this.error=e instanceof Error?e.message:"Unknown error",console.error("Failed to fetch app configuration:",e),this.getFallbackConfiguration()}finally{this.loading=!1}}shouldRefetch(){return Date.now()-this.lastFetch>this.cacheTimeout}getFallbackConfiguration(){return{internal:[{app_name:"tiered_pricing",is_active:!1}],external:[{app_name:"dealer_locator",configurations:{token:""},is_active:!1},{app_name:"google_recaptcha",configurations:{site_key:"",locations:{login:!1,signup:!1,checkout:!1}},is_active:!1},{app_name:"google_tag_manager",configurations:{container_id:""},is_active:!1},{app_name:"google_maps",configurations:{api_key:""},is_active:!1},{app_name:"google_analytics",configurations:{measurement_id:""},is_active:!1},{app_name:"google_adsense",configurations:{publisher_id:""},is_active:!1},{app_name:"google_search_console",configurations:{verification_meta_tag:""},is_active:!1}]}}transformFlatArrayToStructured(e){let t=[],i=[];return e.forEach(e=>{e.configurations||"tiered_pricing"!==e.app_name?["dealer_locator","google_recaptcha","google_tag_manager","google_maps","google_analytics","google_adsense","google_search_console","will-call"].includes(e.app_name)&&i.push({app_name:e.app_name,configurations:e.configurations||{},is_active:e.is_active}):t.push({app_name:e.app_name,is_active:e.is_active})}),{internal:t,external:i}}getExternalConfig(e){var t;if(!this.configuration)return null;let i=null==(t=this.configuration.external)?void 0:t.find(t=>t.app_name===e);return(null==i?void 0:i.is_active)?i.configurations:null}getInternalConfig(e){var t,i;if(!this.configuration)return!1;let n=null==(t=this.configuration.internal)?void 0:t.find(t=>t.app_name===e);return null!=(i=null==n?void 0:n.is_active)&&i}isAppActive(e){var t,i,n;if(!this.configuration)return!1;let a=null==(t=this.configuration.external)?void 0:t.find(t=>t.app_name===e);if(a)return a.is_active;let o=null==(i=this.configuration.internal)?void 0:i.find(t=>t.app_name===e);return null!=(n=null==o?void 0:o.is_active)&&n}getGoogleRecaptchaConfig(){return this.getExternalConfig("google_recaptcha")}isRecaptchaEnabledFor(e){var t,i;if(!this.isAppActive("google_recaptcha"))return!1;let n=this.getGoogleRecaptchaConfig();return null!=(i=null==n||null==(t=n.locations)?void 0:t[e])&&i}getGoogleTagManagerConfig(){return this.getExternalConfig("google_tag_manager")}getGoogleMapsConfig(){return this.getExternalConfig("google_maps")}getGoogleAnalyticsConfig(){return this.getExternalConfig("google_analytics")}getGoogleAdSenseConfig(){return this.getExternalConfig("google_adsense")}getGoogleSearchConsoleConfig(){return this.getExternalConfig("google_search_console")}isDealerLocatorEnabled(){return this.getInternalConfig("dealer_locator")}isWillCallEnabled(){return this.isAppActive("will-call")}getLastError(){return this.error}clearCache(){this.configuration=null,this.lastFetch=0,this.error=null}setCacheTimeout(e){this.cacheTimeout=e}constructor(){this.configuration=null,this.loading=!1,this.error=null,this.lastFetch=0,this.cacheTimeout=1e4}}let a=new n}}]);